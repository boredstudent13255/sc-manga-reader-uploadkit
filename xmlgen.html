<html>
  <style>
body {
  padding: 30px;
}
button {
  margin: 5px;
}
.seriesoverview {
  font-style: italic;
  margin-bottom: 5px;
}
.SeriesTitle {
 margin-bottom: 0px;
}
.SeriesTitleJa {
  margin-bottom: 5px;
  margin-top: -15px;
}
.generated-xml-parent {
  margin-top: 30px;
}
.generated-xml{
  background-color: EEEEEE;
  border-radius: 5px;
  width: 800px;
  height: 300px;
  padding: 10px;
  margin: 5px;
  overflow: scroll;
}
.XMLLabels {
  font-size: 24;
}
.ErrorReporting {
  color: FF0000;
}
.defaulthide {
  visibility: hidden;
}
.generated-xml-parent {
  visibility: hidden;
}
.minitext {
  font-size: 14;
}
  </style>
  <body>
    <h1>SierraComix Manga Reader XML generator - chapter addition to existing series</h1>
      <!--
        Designed to serve as a friendly UI for updating the necessary XML in a chapter upload. Fetches and modifies series.xml, and if applicable, the previous chapter and/or next chapter's chapter.xml. The end user is tasked with filling the UI out and then pasting the generated XML into the places they are told to.
      -->
    <span class="FieldLabel">Parent Series ID: </span><input type="text" id="SeriesIDEntryField" name="SeriesID">
    <button onClick="retrieveSeriesXML('SeriesIDEntryField')">Go</button>
    <span class="ErrorReporting" id="LoadFailedError"></span>

    <div class="defaulthide" id="ChapterDetails">
      <p>
        <h2>New chapter for: "<span class="SeriesTitle"id="SeriesTitle">Series Title Here</span>"</h2>
        <div class="SeriesTitleJa" id="SeriesTitleJa">(Series Title Native Language)</div>
        <div class="seriesoverview" id="seriesdescription">Series Description Here</div>
        <span id="SeriesChapterCount">XX</span> Chapters are listed, ordered <span id="SeriesListOrder">new-to-old / old-to-new</span>
      </p>
    </div>

    <div class="defaulthide" id="ChapterDetailsFields">
      <p>
        <br>
        <h3>Please fill out the below.</h3>
        <span class="FieldLabel">Ch.#: </span><input type="text" id="ChaptNumber" placeholder="Ch.#" style="width: 50px;"> <span class="FieldLabel" >Final page number: </span><input type="text" id="ChaptPageCount" placeholder="##" style="width: 50px;">
        <br><br>
        <span class="FieldLabel">Modify Series ID and storage location for this chapter?</span> <input id="NeedReturnToSetting" onClick="disableSingleField('NeedReturnToSetting','KuseNiNarisouStyleSeriesID')" type="checkbox"> <input type="text" id="KuseNiNarisouStyleSeriesID" placeholder="Chapt True Series ID" style="width: 150px;" disabled>
        <br>
        <span class="minitext">If this chapter belongs to a subseries that should be listed on the parent series' page, use the subseries' internal ID. EX: Kuse ni Narisou would use 'kuse-ni-narisou' rather than 'chou-kuse'. If this is not a subseries chapter, leave this option disabled.</span>
        <br><br>

<!--Main chapter, arc titles form-->
        Include Arc Titles? <input onClick="disableDualField('HasChapterArcTitles', 'ScanlationArcTitle', 'OriginalChapterArcTitle')" id="HasChapterArcTitles" type="checkbox">
        <br>
        <input type="text" id="ScanlationArcTitle" name="ChaptArcTitle" placeholder="English Arc Title" style="width: 500px; font-size: 18;" disabled>
        <p>
          <input type="text" id="OriginalChapterArcTitle" name="ChaptArcTitleJa" placeholder="Japanese Arc Title" style="width: 500px; font-size: 14;" disabled>
        </p>

<!--Main chapter, titles form-->
        Include Chapter Titles? <input onClick="disableDualField('HasChapterTitles', 'ScanlationTitle', 'OriginalChapterTitle')" id="HasChapterTitles" type="checkbox" checked>
        <br>
        <input type="text" id="ScanlationTitle" name="ChaptTitle" placeholder="English Chapter Title" style="width: 500px; font-size: 18;">
        <p>
          <input type="text" id="OriginalChapterTitle" name="ChaptTitleJa" placeholder="Japanese Chapter Title" style="width: 500px; font-size: 14;">
        </p>

<!--Main chapter, description-->
        <input type="text" id="ScanlationSummary" name="ScanSummary" placeholder="English Chapter Summary" style="width: 500px; height: 50px; overflow: scroll;" value="Description Here">

<!--Release info form-->
        <p>
          Released on <input id="InitialReleaseDateSetting" type="text" value="1900/1/1" style="width: 75px;"> 
          <br>
          Scanlated on <input id="ScanlationDateSetting" type="text" value="2020/1/1" style="width: 75px;"> by <input id="ScanlatorSetting" type="text" value="My Future Translations" style="width: 300px;">
          <br>
          <span class="minitext">YYYY/MM/DD, please. No forced digit conformity.</span>
        </p>

<!--Series handling form-->
        <br><br>
        <span class="FieldLabel">Chapter type: </span>
        <select name="ChapterType" id="ChapterReleaseType" serialization>
          <option value="serialization">Serialization</option>
          <option value="one-shot">One-Shot</option>
        </select>
        <br><br>
        <span class="FieldLabel">Upon completion, return to...</span>
        <select name="PageReturnDestination" id="PageReturnDestination" spage disabled>
          <option value="serialization">Series' chapter select</option>
          <option value="one-shot">Series select</option>
        </select>

<!--Previous chapter form-->
        <br><br>
        <span class="FieldLabel">Previous Chapter? <input id="ChaptHasPreviousChapter" type="checkbox" onClick="disableDualField('ChaptHasPreviousChapter', 'PrevChaptSeriesID', 'PrevChaptNumber')" checked></span> <span class="minitext">(Only for use if this chapter <b>already exists</b>.)</span>
        <br>
        <input type="text" id="PrevChaptSeriesID" placeholder="Series ID for chapter" style="width: 150px;"> <input type="text" id="PrevChaptNumber" placeholder="Ch.#" style="width: 50px;"> <button onClick="checkChapterTitle('InsertLastChapt','PrevChaptSeriesID','PrevChaptNumber')">Check Title</button> <span id="InsertLastChapt"></span>

<!--Next chapter form-->
        <br><br>
        <span class="FieldLabel"> Following Chapter? <input id="ChaptHasNextChapter" type="checkbox" onClick="disableDualField('ChaptHasNextChapter', 'NextChaptSeriesID', 'NextChaptNumber')"></span> <span class="minitext">(Only for use if this chapter <b>already exists</b>.)</span>
        <br>
        <input type="text" id="NextChaptSeriesID" placeholder="Series ID for chapter" style="width: 150px;" disabled> <input type="text" id="NextChaptNumber" placeholder="Ch.#" style="width: 50px;" disabled> <button onClick="checkChapterTitle('InsertNextChapt','NextChaptSeriesID','NextChaptNumber')">Check Title</button> <span id="InsertNextChapt"></span>

<!--Chapter Placement drop-down-->
        <br><br>
        <span class="FieldLabel">Placement in chapter navigation:</span>
        <br>
        Directly after 
        <select name="Chapter Placement Setting" id="ChapterPlacementSetting">
          <option value="0">nothing. Place Before All</option>
        </select>

        <br><br><br>
        <p>
          <button onClick="runAllXmlGen()"><h3>Generate XML</h3></button>
        </p>
        <br>
<!--Temporary solution.-->
<button onClick="openGithubPage('nextchaptxml')">Following Chapter Manual XML editing</button><button onClick="openGithubPage('prevchaptxml')">Previous Chapter Manual XML editing</button>
      </p>
    </div>

<!--Series XML-->
    <div class="generated-xml-parent" id="SeriesXMLParent">
      <span class="XMLLabels">Series XML</span> <button onClick="copyToClipboard('SeriesDotXMLReGenerated')">Copy to Clipboard</button><button onClick="openGithubPage('seriesxml')">Go to paste location</button>
      <br><pre><div id="SeriesDotXMLReGenerated" class="generated-xml">
&lt;series&gt;
</div></pre>
    </div>

<!--Current Chapter XML-->
    <div class="generated-xml-parent" id="CurrChaptXMLParent">
      <span class="XMLLabels">Current Chapter (Ch.<span id="CurrentChapterNumberXmlTitle">XX</span>) XML</span> <button onClick="copyToClipboard('CurrentChapterChapterDotXMLReGenerated')">Copy to Clipboard</button><button onClick="openGithubPage('currchaptxml')">Go to paste location</button>
      <br><pre><div id="CurrentChapterChapterDotXMLReGenerated" class="generated-xml">
&lt;chapter&gt;
</div></pre>
    </div>

<!--Next Chapter XML-->
    <div class="generated-xml-parent" id="NextChaptXMLParent">
      <span class="XMLLabels">Following Chapter (Ch.<span id="NextChapterNumberXmlTitle">XX</span>) XML</span> <button onClick="copyToClipboard('NextChapterChapterDotXMLReGenerated')">Copy to Clipboard</button><button onClick="openGithubPage('nextchaptxml')">Go to paste location</button>
      <br><pre><div id="NextChapterChapterDotXMLReGenerated" class="generated-xml">
&lt;chapter&gt;
</div></pre>
    </div>

<!--Previous Chapter XML-->
    <div class="generated-xml-parent" id="PrevChaptXMLParent">
      <span class="XMLLabels">Previous Chapter (Ch.<span id="PrevChapterNumberXmlTitle">XX</span>) XML</span> <button onClick="copyToClipboard('PreviousChapterChapterDotXMLReGenerated')">Copy to Clipboard</button><button onClick="openGithubPage('prevchaptxml')">Go to paste location</button>
      <br><pre><div id="PreviousChapterChapterDotXMLReGenerated" class="generated-xml">
&lt;chapter&gt;
</div></pre>
    </div>

  </body>
  <script>
var SeriesXMLDisplayTitle, SeriesXMLDisplayTitleOrig, SeriesXMLOverview, SeriesXMLChapterTotal, SeriesXMLChapterListOrder, SeriesXMLSeriesID, ChapterEntryInsertionPoint, NextChaptCheckBox, LastChaptCheckBox, NeedReturnToSetting, LastLaunchedFinalXML, ChaptNumberElement;
var SeriesXMLChaptersArray = [];


//Functions

function runAllXmlGen() {
  //NextChaptXMLParent.style.visibility = 'visible';
  //PrevChaptXMLParent.style.visibility = 'visible';
  NextChaptCheckBox = document.getElementById("ChaptHasNextChapter");
  LastChaptCheckBox = document.getElementById("ChaptHasPreviousChapter");

  regenerateSeriesXML()
  generateCurrentChapterXML()

  //Check if user has stated intention to tie to a following chapter, regenerate XML if true
  if (NextChaptCheckBox.checked) {
    regenerateNeighboringChapterXML("NextChapterChapterDotXMLReGenerated")
  }

  //Check if user has stated intention to tie to a previous chapter, regenerate XML if true
  if (LastChaptCheckBox.checked) {
    regenerateNeighboringChapterXML("PreviousChapterChapterDotXMLReGenerated")
  }
}

function regenerateNeighboringChapterXML(ChapterAndInsertPoint) {

}

//Regenerate XML for Parent Series
function regenerateSeriesXML() {
  SeriesXMLParent.style.visibility = 'visible';
  SeriesEntryInsertionPoint = document.querySelector("#SeriesDotXMLReGenerated");
  SeriesEntryInsertionPoint.innerText = '';
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','<series>\n');
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','  <series-id>' + SeriesXMLSeriesID + '</series-id>\n');
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','  <series-display-name>' + SeriesXMLDisplayTitle + '</series-display-name>\n');
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','  <series-original-name>' + SeriesXMLDisplayTitleOrig + '</series-original-name>\n');
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','  <series-overview>' + SeriesXMLOverview + '</series-overview>\n');
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','  <chapter-count>' + ++SeriesXMLChapterTotal + '</chapter-count>\n');
  --SeriesXMLChapterTotal;
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','  <order>' + SeriesXMLChapterListOrder + '</order>\n');
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','  <chapters>\n');
  
  //Insert Chapters
  ChaptNumberElement = document.getElementById("ChaptNumber");
  const NavDropdown = document.getElementById("ChapterPlacementSetting");
  console.log("selected is " + NavDropdown.value);
  ++SeriesXMLChapterTotal;
  ++SeriesXMLChapterTotal;
  let i = 1;
  let i2 = 1;
  NeedReturnToSetting = document.getElementById("NeedReturnToSetting");
  if (NeedReturnToSetting.checked) {
    var NewChapterStorageLocation = "modified";
  } else {
    var NewChapterStorageLocation = SeriesXMLSeriesID;
  }
  if (NavDropdown.value === "0") {
    SeriesEntryInsertionPoint.insertAdjacentText('beforeend','    <ent-' + i + '>' + NewChapterStorageLocation + '/Chapt' + ChaptNumberElement.value + '/</ent-' + i++ + '>\n');
    
  }
  for (i = i; i < SeriesXMLChapterTotal; i++) {
    SeriesEntryInsertionPoint.insertAdjacentText('beforeend','    <ent-' + i + '>' + SeriesXMLChaptersArray.at(i2 - 1) + '</ent-' + i + '>\n');
    console.log("Pasted in " + SeriesXMLChaptersArray.at(i - 1));
    console.log(i + " and " + NavDropdown.value);
    if (i == NavDropdown.value) {
      SeriesEntryInsertionPoint.insertAdjacentText('beforeend','    <ent-' + ++i + '>' + NewChapterStorageLocation + '/Chapt' + ChaptNumberElement.value + '/</ent-' + i + '>\n');
    }
    ++i2;
  } 
  --SeriesXMLChapterTotal;
  --SeriesXMLChapterTotal;

  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','  </chapters>\n');
  SeriesEntryInsertionPoint.insertAdjacentText('beforeend','</series>');
}

//Generate XML for Current Chapter
function generateCurrentChapterXML() {
  CurrChaptXMLParent.style.visibility = 'visible';
  ChapterEntryInsertionPoint = document.querySelector("#CurrentChapterChapterDotXMLReGenerated");
  ChapterEntryInsertionPoint.innerText = '';
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','<chapter>\n');
  NeedReturnToSetting = document.getElementById("NeedReturnToSetting");
  const doArcTitles = document.getElementById("HasChapterArcTitles");
  const doChaptTitles = document.getElementById("HasChapterTitles");


  //"returnto" and "parentseries"
  const SeriesIDEntryFieldElement = document.getElementById("SeriesIDEntryField");
  if (NeedReturnToSetting.checked) {
    const KuseNiNarisouStyleSeriesIDElement = document.getElementById("KuseNiNarisouStyleSeriesID");
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <returnto>' + SeriesIDEntryFieldElement.value + '</returnto>\n');
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','\n');
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <parentseries>' + KuseNiNarisouStyleSeriesIDElement.value + '</parentseries>\n');
  } else {
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <parentseries>' + SeriesIDEntryFieldElement.value + '</parentseries>\n');
  }

  //"parentdisplayname" "chaptersummary" "chapterdisplaynum" "chapternum" "pagecount"
  const ScanlationSummaryElement = document.getElementById("ScanlationSummary");
  ChaptNumberElement = document.getElementById("ChaptNumber");
  const PageLimiter = document.getElementById("ChaptPageCount");
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <parentdisplayname>' + SeriesXMLDisplayTitle + '</parentdisplayname>\n')
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <chaptersummary>' + ScanlationSummaryElement.value + '</chaptersummary>\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <chapterdisplaynum>' + ChaptNumberElement.value + '</chapterdisplaynum>\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <chapternum>' + verifyDoubleDigitMinimumConformity(ChaptNumberElement.value) + '</chapternum>\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <pagecount>' + PageLimiter.value + '</pagecount>\n');

  //"arctitle" and "ja-arc-title"
  if (doArcTitles.checked) {
    const ArcTitleEn = document.getElementById("ScanlationArcTitle");
    const ArcTitleJa = document.getElementById("OriginalChapterArcTitle");
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <arctitle>' + ArcTitleEn.value + '</arctitle>\n');
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <ja-arc-title>' + ArcTitleJa.value + '</ja-arc-title>\n');
  }

  //"chaptertitle" and "ja-chapter-title"
  if (doChaptTitles.checked) {
    const ChapterTitleEn = document.getElementById("ScanlationTitle");
    const ChapterTitleJa = document.getElementById("OriginalChapterTitle");
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <chaptertitle>' + ChapterTitleEn.value + '</chaptertitle>\n');
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <ja-chapter-title>' + ChapterTitleJa.value + '</ja-chapter-title>\n');
  }

  //"publisd" "scanlatd" "scanlator" "type" "returnlinkstyle"
  const PublicationDateElement = document.getElementById("InitialReleaseDateSetting");
  const ScanlationDateElement = document.getElementById("ScanlationDateSetting");
  const ScanlatorElement = document.getElementById("ScanlatorSetting");
  const ReleaseTypeElement = document.getElementById("ChapterReleaseType");
  const ReturnStyleElement = document.getElementById("PageReturnDestination");
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <publisd>' + PublicationDateElement.value + '</publisd>\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <scanlatd>' + ScanlationDateElement.value + '</scanlatd>\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <scanlator>' + ScanlatorElement.value + '</scanlator>\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <type>' + ReleaseTypeElement.value + '</type>\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <returnlinkstyle>' + ReturnStyleElement.value + '</returnlinkstyle>\n');
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','\n');

  //"next-series" "next-number"
  const NextChapterIDElement = document.getElementById("NextChaptSeriesID");
  const NextChapterNumElement = document.getElementById("NextChaptNumber");
  if (NextChaptCheckBox.checked) {
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <next-series>' + NextChapterIDElement.value + '</next-series>\n');
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <next-number>' + verifyDoubleDigitMinimumConformity(NextChapterNumElement.value) + '</next-number>\n');
  } else {
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <next-series>null</next-series>\n');
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <next-number>null</next-number>\n');
  }

  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','\n');

  //"previous-series" "previous-chapter"
  const PreviousChapterIDElement = document.getElementById("PrevChaptSeriesID");
  const PreviousChapterNumElement = document.getElementById("PrevChaptNumber");
  if (LastChaptCheckBox.checked) {
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <previous-series>' + PreviousChapterIDElement.value + '</previous-series>\n');
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <previous-chapter>' + verifyDoubleDigitMinimumConformity(PreviousChapterNumElement.value) + '</previous-chapter>\n');
  } else {
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <previous-series>null</previous-series>\n');
    ChapterEntryInsertionPoint.insertAdjacentText('beforeend','  <previous-chapter>null</previous-chapter>\n');
  }

  //closing tag
  ChapterEntryInsertionPoint.insertAdjacentText('beforeend','</chapter>');

}

function testForClick() {
  console.log("Clicked checkbox!!");
}
function testForClick2() {
  console.log("Clicked other checkbox!!");
}

function retrieveSeriesXML(SeriesID) {
  var UserSpecID = document.getElementById(SeriesID).value;
  console.log("User specified ID is '" + UserSpecID + "'.");
  loadSeriesXML(UserSpecID);
  //const SeriesIDEmbedPoints = document.getElementById('seriesidembed');
  //SeriesIDEmbedPoints.innerHTML = UserSpecID;
}


function loadSeriesXML(SeriesIDToLoad) {
  //Loads XML code
  var text, parser, seriesXML;
  text = loadFileToElement("https://boredstudent13255.github.io/sc-manga-reader/titles/" + SeriesIDToLoad + "/series.xml");
  parser = new DOMParser();
  seriesXML = parser.parseFromString(text,"text/xml");

  //Fills out unmodifiable series fields
  const SeriesTitleField = document.getElementById('SeriesTitle');
  const SeriesTitleJaField = document.getElementById('SeriesTitleJa');
  const SeriesDescriptionField = document.getElementById('seriesdescription');
  const SeriesChapterCount = document.getElementById('SeriesChapterCount');
  const SeriesChapterListOrder = document.getElementById('SeriesListOrder');
  const SeriesXMLParent = document.getElementById('SeriesXMLParent');
  const CurrChaptXMLParent = document.getElementById('CurrChaptXMLParent');
  const NextChaptXMLParent = document.getElementById('NextChaptXMLParent');
  const PrevChaptXMLParent = document.getElementById('PrevChaptXMLParent');
  const ErrorField = document.getElementById('LoadFailedError');
  const NextChaptSeriesID = document.getElementById('NextChaptSeriesID');
  const PrevChaptSeriesID = document.getElementById('PrevChaptSeriesID');
  try {
    SeriesXMLSeriesID = seriesXML.getElementsByTagName("series-id")[0].childNodes[0].nodeValue;
    SeriesXMLDisplayTitle = seriesXML.getElementsByTagName("series-display-name")[0].childNodes[0].nodeValue;
    SeriesXMLDisplayTitleOrig = seriesXML.getElementsByTagName("series-original-name")[0].childNodes[0].nodeValue;
    SeriesXMLOverview = seriesXML.getElementsByTagName("series-overview")[0].childNodes[0].nodeValue;
    SeriesXMLChapterTotal = seriesXML.getElementsByTagName("chapter-count")[0].childNodes[0].nodeValue;
    SeriesXMLChapterListOrder = seriesXML.getElementsByTagName("order")[0].childNodes[0].nodeValue;
    const ChapterDropdownSelect = document.getElementById("ChapterPlacementSetting");
    var holdCurrentEntry;
    //Loop to collect chapter entries
    ++SeriesXMLChapterTotal
    for (let i = 1; i < SeriesXMLChapterTotal; i++) {
      //console.log("ent-" + i);
      holdCurrentEntry = seriesXML.getElementsByTagName("ent-" + i)[0].childNodes[0].nodeValue;
      //console.log(holdCurrentEntry);
      SeriesXMLChaptersArray.push(holdCurrentEntry);
      ChapterDropdownSelect.insertAdjacentHTML('beforeend',"<option value='" + i + "'>" + holdCurrentEntry.replaceAll('/Chapt',' chapter ') + "</option>");
    }
    SeriesXMLChapterTotal--
    //console.log(SeriesXMLChaptersArray);

    SeriesTitleField.innerHTML = SeriesXMLDisplayTitle;
    SeriesTitleJaField.innerHTML = "(" + SeriesXMLDisplayTitleOrig + ")";
    SeriesDescriptionField.innerHTML = SeriesXMLOverview;
    SeriesChapterCount.innerHTML = SeriesXMLChapterTotal;
    if (SeriesXMLChapterListOrder === "afterend") {
      SeriesChapterListOrder.innerHTML = "from Newest to Oldest";
    } else {
      SeriesChapterListOrder.innerHTML = "from Oldest to Newest";
      SeriesXMLChapterListOrder = "beforebegin"; //Will correct a malformed entry upon regeneration of series.xml. As of writing all possible entries are functional, and will be read as "beforebegin", but this may change.
    }
    const ChapterDetails = document.getElementById('ChapterDetails');
    ChapterDetails.style.visibility = 'visible';
    ChapterDetailsFields.style.visibility = 'visible';
    ErrorField.style.visibility = 'hidden';
    NextChaptSeriesID.value = SeriesIDToLoad;
    PrevChaptSeriesID.value = SeriesIDToLoad;
  } catch {
    console.error("User attempted to load nonexistent or malformed series XML. Generated URL: 'https://boredstudent13255.github.io/sc-manga-reader/titles/" + SeriesIDToLoad + "/series.xml'");
    ErrorField.innerHTML = 'Could not load data from XML. Check for typos.';
    ErrorField.style.visibility = 'visible';
    ChapterDetails.style.visibility = 'hidden';
    ChapterDetailsFields.style.visibility = 'hidden';
    SeriesXMLParent.style.visibility = 'hidden';
    CurrChaptXMLParent.style.visibility = 'hidden';
    NextChaptXMLParent.style.visibility = 'hidden';
    PrevChaptXMLParent.style.visibility = 'hidden';
  }

}

function loadFileToElement(filename) {
  var xmlHTTP = new XMLHttpRequest();
  try
  {
  xmlHTTP.open("GET", filename, false);
  xmlHTTP.send(null);
  }
  catch (e) {
    console.error("Unable to load the requested XML.");
    return;
  }

  return xmlHTTP.responseText;
}

function checkChapterTitle(inserttarget, seriesidfield, chapternumfield) {
  const TitleInsertionPoint = document.getElementById(inserttarget);
  const ChapterSeriesIDContainer = document.getElementById(seriesidfield);
  const ChapterNumberContainer =  document.getElementById(chapternumfield);

  const ChapterNumber = verifyDoubleDigitMinimumConformity(ChapterNumberContainer.value); //Write function to verify that chapter number is double-digits or higher
  //const ChapterNumber = ChapterNumberContainer.value; //DO NOT KEEP THIS VERSION OF THIS IN.

  const ChapterSeriesID = ChapterSeriesIDContainer.value;

  var text, parser, ChaptXML;
  text = loadFileToElement("https://boredstudent13255.github.io/sc-manga-reader/titles/" + ChapterSeriesID + "/Chapt" + ChapterNumber + "/chapter.xml");
  parser = new DOMParser();
  ChaptXML = parser.parseFromString(text,"text/xml");

  try {
    if (text.includes('chaptertitle')) {
      TitleInsertionPoint.innerHTML = ChaptXML.getElementsByTagName("parentdisplayname")[0].childNodes[0].nodeValue + " - Chapter " + ChaptXML.getElementsByTagName("chapterdisplaynum")[0].childNodes[0].nodeValue + ": " + ChaptXML.getElementsByTagName("chaptertitle")[0].childNodes[0].nodeValue;
    } else {
      TitleInsertionPoint.innerHTML = ChaptXML.getElementsByTagName("parentdisplayname")[0].childNodes[0].nodeValue + " - Chapter " + ChaptXML.getElementsByTagName("chapterdisplaynum")[0].childNodes[0].nodeValue;
    }
  } catch {
    console.error("Chapter XML parsing failed");
  }
}


//Dis-Enable Single Field
function disableSingleField(checkboxid, targetid) {
  const Target1 = document.getElementById(targetid);
  const checkBox = document.getElementById(checkboxid);
  if (checkBox.checked) {
    Target1.disabled = false;
  } else {
    Target1.disabled = true;
  }
}

//Dis-Enable Double Field
function disableDualField(checkboxid, targetid, targetid2) {
  const Target1 = document.getElementById(targetid);
  const Target2 = document.getElementById(targetid2);
  const checkBox = document.getElementById(checkboxid);
  if (checkBox.checked) {
    Target1.disabled = false;
    Target2.disabled = false;
  } else {
    Target1.disabled = true;
    Target2.disabled = true;
  }
}

//Checks chapter input numbers. If it's a single digit number or decimal, adds a leading zero for compatibility with my existing numbering system. Chapter numbers that are actually strings or are beyond 9.999... will be unmodified.
function verifyDoubleDigitMinimumConformity(numToCheck) {
  if (isNaN(numToCheck)) {
    return numToCheck;
  } else {
    ++numToCheck;
    --numToCheck;
    console.log(numToCheck);
    console.log(typeof(numToCheck));
    let testVarType = typeof(numToCheck)
    if (testVarType === "number" && numToCheck < 10 && numToCheck > -1) {
      return "0" + numToCheck;
    } else {
      return numToCheck;
    }
  }
}

//Copy contents of DIV to clipboard
function copyToClipboard(text) {
  const source = document.getElementById(text);
  console.log(source.innerText);

  text = source.innerText;

  if (navigator.clipboard && window.isSecureContext) {
    return navigator.clipboard.writeText(text);
  } else {
    const textArea = document.createElement("textarea");
    textArea.value = text;
    textArea.style.position = "absolute";
    textArea.style.opacity = 0;
    document.body.appendChild(textArea);
    textArea.select();
    return new Promise((resolve, reject) => {
      document.execCommand('copy') ? resolve() : reject();
      textArea.remove();
    });
  }
}

//Jump to location for where to paste in the newly made XML
function openGithubPage(target) {

  //Auto-create and fill out new file for new chapter's XML
  if (target === "currchaptxml") {
    const source = document.getElementById("CurrentChapterChapterDotXMLReGenerated");
    LastLaunchedFinalXML = source.innerText;
    LastLaunchedFinalXML = LastLaunchedFinalXML.replaceAll("\n","%0A");
    const SeriesIDEntryFieldElement = document.getElementById("SeriesIDEntryField");
    const ChaptNumberElement = document.getElementById("ChaptNumber");
    if (NeedReturnToSetting.checked) {
      const KuseNiNarisouStyleSeriesIDElement = document.getElementById("KuseNiNarisouStyleSeriesID");
      window.open("https://github.com/boredstudent13255/sc-manga-reader/new/main/titles/" + KuseNiNarisouStyleSeriesIDElement.value + "?filename=Chapt" + ChaptNumberElement.value + "/chapter.xml&value=" + LastLaunchedFinalXML, '_blank').focus();
    } else {
      window.open("https://github.com/boredstudent13255/sc-manga-reader/new/main/titles/" + SeriesIDEntryFieldElement.value + "?filename=Chapt" + ChaptNumberElement.value + "/chapter.xml&value=" + LastLaunchedFinalXML, '_blank').focus();
    }
  }

  if (target === "seriesxml") {
    const SeriesIDEntryFieldElement = document.getElementById("SeriesIDEntryField");
    window.open("https://github.com/boredstudent13255/sc-manga-reader/edit/main/titles/" + SeriesIDEntryFieldElement.value + "/series.xml?value=" + LastLaunchedFinalXML, '_blank').focus();
  }
  if (target === "nextchaptxml" && NextChaptCheckBox.checked) {
    const SeriesIDEntryFieldElement = document.getElementById("NextChaptSeriesID");
    const ChaptNumberElement = document.getElementById("NextChaptNumber");
    window.open("https://github.com/boredstudent13255/sc-manga-reader/edit/main/titles/" + SeriesIDEntryFieldElement.value + "/Chapt" + ChaptNumberElement.value + "/chapter.xml", '_blank').focus();
  } 
  if (target === "prevchaptxml" && LastChaptCheckBox.checked) {
    const SeriesIDEntryFieldElement = document.getElementById("PrevChaptSeriesID");
    const ChaptNumberElement = document.getElementById("PrevChaptNumber");
    window.open("https://github.com/boredstudent13255/sc-manga-reader/edit/main/titles/" + SeriesIDEntryFieldElement.value + "/Chapt" + ChaptNumberElement.value + "/chapter.xml", '_blank').focus();
  } 

}


  </script>
</html>
